{
  "metadata": {
    "source_dataset": "ccibt-hack25ww7-750.worldbank_staging_dataset",
    "target_dataset": "ccibt-hack25ww7-750.worldbank_target_dataset",
    "generated_at": "2025-12-16T00:00:00Z",
    "confidence": "high",
    "mode": "FIX"
  },
  "mappings": [
    {
      "source_table": "ccibt-hack25ww7-750.worldbank_staging_dataset.staging_countries",
      "target_table": "ccibt-hack25ww7-750.worldbank_target_dataset.dim_country",
      "match_confidence": 0.95,
      "column_mappings": [
        {
          "source_column": "country_code",
          "target_column": "country_key",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Direct mapping, serves as primary key."
        },
        {
          "source_column": "country_name",
          "target_column": "country_name",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Direct mapping."
        },
        {
          "source_column": "iso3",
          "target_column": "iso3",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Direct mapping."
        },
        {
          "source_column": "region",
          "target_column": "region",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Direct mapping."
        },
        {
          "source_column": "income_group",
          "target_column": "income_group",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Direct mapping."
        }
      ],
      "unmapped_source_columns": [],
      "unmapped_target_columns": [],
      "mapping_errors": [],
      "validation_rules": [
        {
          "column": "country_key",
          "type": "NOT_NULL",
          "reason": "Target column is REQUIRED"
        }
      ],
      "primary_key": [
        "country_key"
      ],
      "uniqueness_constraints": [
        "iso3"
      ]
    },
    {
      "source_table": "ccibt-hack25ww7-750.worldbank_staging_dataset.staging_indicators_meta",
      "target_table": "ccibt-hack25ww7-750.worldbank_target_dataset.dim_indicator",
      "match_confidence": 0.95,
      "column_mappings": [
        {
          "source_column": "indicator_code",
          "target_column": "indicator_code",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Direct mapping, serves as primary key."
        },
        {
          "source_column": "indicator_name",
          "target_column": "indicator_name",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Direct mapping."
        },
        {
          "source_column": "topic",
          "target_column": "topic",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Direct mapping."
        }
      ],
      "unmapped_source_columns": [],
      "unmapped_target_columns": [],
      "mapping_errors": [],
      "validation_rules": [
        {
          "column": "indicator_code",
          "type": "NOT_NULL",
          "reason": "Target column is REQUIRED"
        }
      ],
      "primary_key": [
        "indicator_code"
      ],
      "uniqueness_constraints": []
    },
    {
      "source_table": "GENERATED_FROM_STAGING_YEARS",
      "target_table": "ccibt-hack25ww7-750.worldbank_target_dataset.dim_time",
      "match_confidence": 0.8,
      "column_mappings": [
        {
          "source_column": "year",
          "target_column": "year",
          "source_type": "INTEGER",
          "target_type": "INTEGER",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Derived from distinct year values across all staging tables, serves as primary key."
        },
        {
          "source_column": "GENERATED",
          "target_column": "year_key",
          "source_type": "EXPRESSION",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: CAST(year AS STRING)",
          "notes": "Generated by casting the year column to a string."
        }
      ],
      "unmapped_source_columns": [],
      "unmapped_target_columns": [],
      "mapping_errors": [],
      "validation_rules": [
        {
          "column": "year",
          "type": "NOT_NULL",
          "reason": "Target column is REQUIRED"
        },
        {
          "column": "year",
          "type": "NUMERIC_RANGE",
          "reason": "Reasonable range for historical year data",
          "min_value": 1900,
          "max_value": 2100
        }
      ],
      "primary_key": [
        "year"
      ],
      "uniqueness_constraints": []
    },
    {
      "source_table": "ccibt-hack25ww7-750.worldbank_staging_dataset.staging_co2_emissions",
      "target_table": "ccibt-hack25ww7-750.worldbank_target_dataset.fact_indicator_values",
      "match_confidence": 0.9,
      "column_mappings": [
        {
          "source_column": "country_code",
          "target_column": "country_key",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping country_code from source to country_key in fact table."
        },
        {
          "source_column": "year",
          "target_column": "year",
          "source_type": "INTEGER",
          "target_type": "INTEGER",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping year from source to year in fact table."
        },
        {
          "source_column": "indicator_code",
          "target_column": "indicator_code",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping indicator_code from source to indicator_code in fact table."
        },
        {
          "source_column": "value",
          "target_column": "numeric_value",
          "source_type": "INTEGER",
          "target_type": "NUMERIC",
          "type_conversion_needed": true,
          "transformation": "CAST(value AS NUMERIC)",
          "notes": "Casting CO2 emissions value from INTEGER to NUMERIC."
        },
        {
          "source_column": "GENERATED",
          "target_column": "data_source",
          "source_type": "EXPRESSION",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: 'staging_co2_emissions'",
          "notes": "Automatically setting data source to the staging table name."
        },
        {
          "source_column": "GENERATED",
          "target_column": "loaded_at",
          "source_type": "EXPRESSION",
          "target_type": "TIMESTAMP",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: CURRENT_TIMESTAMP()",
          "notes": "Auto-generated timestamp for audit purposes."
        }
      ],
      "unmapped_source_columns": [
        "iso3"
      ],
      "unmapped_target_columns": [],
      "mapping_errors": [],
      "validation_rules": [],
      "primary_key": [
        "country_key",
        "year",
        "indicator_code"
      ],
      "uniqueness_constraints": [
        "country_key",
        "year",
        "indicator_code"
      ]
    },
    {
      "source_table": "ccibt-hack25ww7-750.worldbank_staging_dataset.staging_gdp",
      "target_table": "ccibt-hack25ww7-750.worldbank_target_dataset.fact_indicator_values",
      "match_confidence": 0.9,
      "column_mappings": [
        {
          "source_column": "country_code",
          "target_column": "country_key",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping country_code from source to country_key in fact table."
        },
        {
          "source_column": "year",
          "target_column": "year",
          "source_type": "INTEGER",
          "target_type": "INTEGER",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping year from source to year in fact table."
        },
        {
          "source_column": "indicator_code",
          "target_column": "indicator_code",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping indicator_code from source to indicator_code in fact table."
        },
        {
          "source_column": "value",
          "target_column": "numeric_value",
          "source_type": "INTEGER",
          "target_type": "NUMERIC",
          "type_conversion_needed": true,
          "transformation": "CAST(value AS NUMERIC)",
          "notes": "Casting GDP value from INTEGER to NUMERIC."
        },
        {
          "source_column": "GENERATED",
          "target_column": "data_source",
          "source_type": "EXPRESSION",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: 'staging_gdp'",
          "notes": "Automatically setting data source to the staging table name."
        },
        {
          "source_column": "GENERATED",
          "target_column": "loaded_at",
          "source_type": "EXPRESSION",
          "target_type": "TIMESTAMP",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: CURRENT_TIMESTAMP()",
          "notes": "Auto-generated timestamp for audit purposes."
        }
      ],
      "unmapped_source_columns": [
        "iso3"
      ],
      "unmapped_target_columns": [],
      "mapping_errors": [],
      "validation_rules": [],
      "primary_key": [
        "country_key",
        "year",
        "indicator_code"
      ],
      "uniqueness_constraints": [
        "country_key",
        "year",
        "indicator_code"
      ]
    },
    {
      "source_table": "ccibt-hack25ww7-750.worldbank_staging_dataset.staging_life_expectancy",
      "target_table": "ccibt-hack25ww7-750.worldbank_target_dataset.fact_indicator_values",
      "match_confidence": 0.9,
      "column_mappings": [
        {
          "source_column": "country_code",
          "target_column": "country_key",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping country_code from source to country_key in fact table."
        },
        {
          "source_column": "year",
          "target_column": "year",
          "source_type": "INTEGER",
          "target_type": "INTEGER",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping year from source to year in fact table."
        },
        {
          "source_column": "indicator_code",
          "target_column": "indicator_code",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping indicator_code from source to indicator_code in fact table."
        },
        {
          "source_column": "value",
          "target_column": "numeric_value",
          "source_type": "FLOAT",
          "target_type": "NUMERIC",
          "type_conversion_needed": true,
          "transformation": "CAST(value AS NUMERIC)",
          "notes": "Casting life expectancy value from FLOAT to NUMERIC."
        },
        {
          "source_column": "GENERATED",
          "target_column": "data_source",
          "source_type": "EXPRESSION",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: 'staging_life_expectancy'",
          "notes": "Automatically setting data source to the staging table name."
        },
        {
          "source_column": "GENERATED",
          "target_column": "loaded_at",
          "source_type": "EXPRESSION",
          "target_type": "TIMESTAMP",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: CURRENT_TIMESTAMP()",
          "notes": "Auto-generated timestamp for audit purposes."
        }
      ],
      "unmapped_source_columns": [
        "iso3"
      ],
      "unmapped_target_columns": [],
      "mapping_errors": [],
      "validation_rules": [],
      "primary_key": [
        "country_key",
        "year",
        "indicator_code"
      ],
      "uniqueness_constraints": [
        "country_key",
        "year",
        "indicator_code"
      ]
    },
    {
      "source_table": "ccibt-hack25ww7-750.worldbank_staging_dataset.staging_population",
      "target_table": "ccibt-hack25ww7-750.worldbank_target_dataset.fact_indicator_values",
      "match_confidence": 0.9,
      "column_mappings": [
        {
          "source_column": "country_code",
          "target_column": "country_key",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping country_code from source to country_key in fact table."
        },
        {
          "source_column": "year",
          "target_column": "year",
          "source_type": "INTEGER",
          "target_type": "INTEGER",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping year from source to year in fact table."
        },
        {
          "source_column": "indicator_code",
          "target_column": "indicator_code",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping indicator_code from source to indicator_code in fact table."
        },
        {
          "source_column": "value",
          "target_column": "numeric_value",
          "source_type": "INTEGER",
          "target_type": "NUMERIC",
          "type_conversion_needed": true,
          "transformation": "CAST(value AS NUMERIC)",
          "notes": "Casting population value from INTEGER to NUMERIC."
        },
        {
          "source_column": "GENERATED",
          "target_column": "data_source",
          "source_type": "EXPRESSION",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: 'staging_population'",
          "notes": "Automatically setting data source to the staging table name."
        },
        {
          "source_column": "GENERATED",
          "target_column": "loaded_at",
          "source_type": "EXPRESSION",
          "target_type": "TIMESTAMP",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: CURRENT_TIMESTAMP()",
          "notes": "Auto-generated timestamp for audit purposes."
        }
      ],
      "unmapped_source_columns": [
        "iso3"
      ],
      "unmapped_target_columns": [],
      "mapping_errors": [],
      "validation_rules": [],
      "primary_key": [
        "country_key",
        "year",
        "indicator_code"
      ],
      "uniqueness_constraints": [
        "country_key",
        "year",
        "indicator_code"
      ]
    },
    {
      "source_table": "ccibt-hack25ww7-750.worldbank_staging_dataset.staging_poverty_headcount",
      "target_table": "ccibt-hack25ww7-750.worldbank_target_dataset.fact_indicator_values",
      "match_confidence": 0.9,
      "column_mappings": [
        {
          "source_column": "country_code",
          "target_column": "country_key",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping country_code from source to country_key in fact table."
        },
        {
          "source_column": "year",
          "target_column": "year",
          "source_type": "INTEGER",
          "target_type": "INTEGER",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping year from source to year in fact table."
        },
        {
          "source_column": "indicator_code",
          "target_column": "indicator_code",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping indicator_code from source to indicator_code in fact table."
        },
        {
          "source_column": "value",
          "target_column": "numeric_value",
          "source_type": "FLOAT",
          "target_type": "NUMERIC",
          "type_conversion_needed": true,
          "transformation": "CAST(value AS NUMERIC)",
          "notes": "Casting poverty headcount value from FLOAT to NUMERIC."
        },
        {
          "source_column": "GENERATED",
          "target_column": "data_source",
          "source_type": "EXPRESSION",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: 'staging_poverty_headcount'",
          "notes": "Automatically setting data source to the staging table name."
        },
        {
          "source_column": "GENERATED",
          "target_column": "loaded_at",
          "source_type": "EXPRESSION",
          "target_type": "TIMESTAMP",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: CURRENT_TIMESTAMP()",
          "notes": "Auto-generated timestamp for audit purposes."
        }
      ],
      "unmapped_source_columns": [
        "iso3"
      ],
      "unmapped_target_columns": [],
      "mapping_errors": [],
      "validation_rules": [],
      "primary_key": [
        "country_key",
        "year",
        "indicator_code"
      ],
      "uniqueness_constraints": [
        "country_key",
        "year",
        "indicator_code"
      ]
    },
    {
      "source_table": "ccibt-hack25ww7-750.worldbank_staging_dataset.staging_primary_enrollment",
      "target_table": "ccibt-hack25ww7-750.worldbank_target_dataset.fact_indicator_values",
      "match_confidence": 0.9,
      "column_mappings": [
        {
          "source_column": "country_code",
          "target_column": "country_key",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping country_code from source to country_key in fact table."
        },
        {
          "source_column": "year",
          "target_column": "year",
          "source_type": "INTEGER",
          "target_type": "INTEGER",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping year from source to year in fact table."
        },
        {
          "source_column": "indicator_code",
          "target_column": "indicator_code",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Mapping indicator_code from source to indicator_code in fact table."
        },
        {
          "source_column": "value",
          "target_column": "numeric_value",
          "source_type": "FLOAT",
          "target_type": "NUMERIC",
          "type_conversion_needed": true,
          "transformation": "CAST(value AS NUMERIC)",
          "notes": "Casting primary enrollment value from FLOAT to NUMERIC."
        },
        {
          "source_column": "GENERATED",
          "target_column": "data_source",
          "source_type": "EXPRESSION",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: 'staging_primary_enrollment'",
          "notes": "Automatically setting data source to the staging table name."
        },
        {
          "source_column": "GENERATED",
          "target_column": "loaded_at",
          "source_type": "EXPRESSION",
          "target_type": "TIMESTAMP",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: CURRENT_TIMESTAMP()",
          "notes": "Auto-generated timestamp for audit purposes."
        }
      ],
      "unmapped_source_columns": [
        "iso3"
      ],
      "unmapped_target_columns": [],
      "mapping_errors": [],
      "validation_rules": [],
      "primary_key": [
        "country_key",
        "year",
        "indicator_code"
      ],
      "uniqueness_constraints": [
        "country_key",
        "year",
        "indicator_code"
      ]
    },
    {
      "source_table": "ccibt-hack25ww7-750.worldbank_staging_dataset.staging_gdp",
      "target_table": "ccibt-hack25ww7-750.worldbank_target_dataset.agg_country_year",
      "match_confidence": 0.7,
      "column_mappings": [
        {
          "source_column": "country_code",
          "target_column": "country_key",
          "source_type": "STRING",
          "target_type": "STRING",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Direct mapping from staging_gdp, joined with other tables on this column."
        },
        {
          "source_column": "year",
          "target_column": "year",
          "source_type": "INTEGER",
          "target_type": "INTEGER",
          "type_conversion_needed": false,
          "transformation": null,
          "notes": "Direct mapping from staging_gdp, joined with other tables on this column."
        },
        {
          "source_column": "value",
          "target_column": "gdp",
          "source_type": "INTEGER",
          "target_type": "NUMERIC",
          "type_conversion_needed": true,
          "transformation": "CAST(value AS NUMERIC)",
          "notes": "GDP value from staging_gdp table."
        },
        {
          "source_column": "staging_population.value",
          "target_column": "population",
          "source_type": "INTEGER",
          "target_type": "INTEGER",
          "type_conversion_needed": false,
          "transformation": "staging_population.value",
          "notes": "Population value from staging_population table, joined by country_code and year."
        },
        {
          "source_column": "GENERATED",
          "target_column": "gdp_per_capita",
          "source_type": "EXPRESSION",
          "target_type": "NUMERIC",
          "type_conversion_needed": false,
          "transformation": "DEFAULT: CAST(agg_country_year.gdp AS NUMERIC) / agg_country_year.population",
          "notes": "Calculated as GDP divided by Population. Requires GDP and Population to be joined first."
        },
        {
          "source_column": "staging_life_expectancy.value",
          "target_column": "life_expectancy",
          "source_type": "FLOAT",
          "target_type": "FLOAT",
          "type_conversion_needed": false,
          "transformation": "staging_life_expectancy.value",
          "notes": "Life expectancy value from staging_life_expectancy table, joined by country_code and year."
        },
        {
          "source_column": "staging_co2_emissions.value",
          "target_column": "co2_emissions",
          "source_type": "INTEGER",
          "target_type": "INTEGER",
          "type_conversion_needed": false,
          "transformation": "staging_co2_emissions.value",
          "notes": "CO2 emissions value from staging_co2_emissions table, joined by country_code and year."
        },
        {
          "source_column": "staging_primary_enrollment.value",
          "target_column": "primary_enrollment",
          "source_type": "FLOAT",
          "target_type": "FLOAT",
          "type_conversion_needed": false,
          "transformation": "staging_primary_enrollment.value",
          "notes": "Primary enrollment value from staging_primary_enrollment table, joined by country_code and year."
        },
        {
          "source_column": "staging_poverty_headcount.value",
          "target_column": "poverty_headcount",
          "source_type": "FLOAT",
          "target_type": "FLOAT",
          "type_conversion_needed": false,
          "transformation": "staging_poverty_headcount.value",
          "notes": "Poverty headcount value from staging_poverty_headcount table, joined by country_code and year."
        }
      ],
      "unmapped_source_columns": [
        "iso3",
        "indicator_code"
      ],
      "unmapped_target_columns": [],
      "mapping_errors": [],
      "validation_rules": [],
      "primary_key": [
        "country_key",
        "year"
      ],
      "uniqueness_constraints": [
        "country_key",
        "year"
      ]
    }
  ]
}